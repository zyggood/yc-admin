# =============================================
# 生产环境配置 (application-prod.properties)
# =============================================

# 服务器配置
server.port=8080

# =============================================
# 数据库配置 - PostgreSQL（生产环境）
# =============================================
# 注意：生产环境数据库配置应通过环境变量或外部配置文件设置
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/admin_prod}
spring.datasource.username=${DB_USERNAME:admin_prod}
spring.datasource.password=${DB_PASSWORD:prod123}
spring.datasource.driver-class-name=org.postgresql.Driver

# 连接池配置（生产环境优化）
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# =============================================
# JPA/Hibernate 配置
# =============================================
# DDL 自动生成策略 - 生产环境使用 validate
spring.jpa.hibernate.ddl-auto=validate

# 关闭 SQL 显示（生产环境）
spring.jpa.show-sql=false

# 关闭 SQL 格式化（生产环境）
spring.jpa.properties.hibernate.format_sql=false

# 数据库方言
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# 性能优化配置
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

# =============================================
# 日志配置
# =============================================
# 根日志级别
logging.level.root=WARN

# 应用日志级别
logging.level.com.yc.admin=INFO

# 关闭调试日志
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN

# 日志文件配置
logging.file.name=${LOG_PATH:/var/log/admin}/admin-prod.log
logging.file.max-size=500MB
logging.file.max-history=90
logging.file.total-size-cap=10GB

# 日志格式
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{traceId}] %logger{36} - %msg%n
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{traceId}] %logger{36} - %msg%n

# =============================================
# 安全配置
# =============================================
# 生产环境启用完整安全
spring.security.csrf.enabled=true

# =============================================
# 缓存配置
# =============================================
# 生产环境使用 Redis 缓存
spring.cache.type=redis
spring.cache.redis.time-to-live=3600000
spring.cache.redis.cache-null-values=false

# =============================================
# Redis 配置（生产环境）
# =============================================
spring.redis.host=${REDIS_HOST:localhost}
spring.redis.port=${REDIS_PORT:6379}
spring.redis.password=${REDIS_PASSWORD:}
spring.redis.database=0
spring.redis.timeout=2000ms
spring.redis.lettuce.pool.max-active=20
spring.redis.lettuce.pool.max-idle=10
spring.redis.lettuce.pool.min-idle=5
spring.redis.lettuce.pool.max-wait=-1ms

# =============================================
# 监控配置
# =============================================
# Actuator 端点配置（生产环境限制）
management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.show-details=never
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

# Prometheus 监控
management.metrics.export.prometheus.enabled=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true

# =============================================
# 邮件配置（生产环境）
# =============================================
spring.mail.host=${MAIL_HOST:smtp.example.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:admin@example.com}
spring.mail.password=${MAIL_PASSWORD:your-mail-password}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# =============================================
# 性能配置
# =============================================
# 线程池配置
spring.task.execution.pool.core-size=10
spring.task.execution.pool.max-size=50
spring.task.execution.pool.queue-capacity=1000
spring.task.execution.thread-name-prefix=admin-task-

# =============================================
# 其他生产配置
# =============================================
# 关闭调试模式
debug=false

# 压缩配置
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# SSL 配置（如果使用 HTTPS）
# server.ssl.enabled=true
# server.ssl.key-store=${SSL_KEYSTORE_PATH:/path/to/keystore.p12}
# server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD:your-keystore-password}
# server.ssl.key-store-type=PKCS12

# 优雅关闭
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s